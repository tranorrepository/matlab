function test_1()
%
%
%


clear variables; clc;
clf(figure(200))

folder_str0 = 'C:/Users/Ming.Chen/Desktop/results/12_07_0/';
folder_str1 = 'C:/Users/Ming.Chen/Desktop/results/12_07_1/';
rot_format = 'fg_%d_sec_%d_lane_%d_merging_%d_rotated.txt';
pola_format = 'fg_%d_sec_%d_lane_%d_merging_%d_pola.txt';
poly_format = 'fg_%d_sec_%d_lane_%d_merging_%d_poly.txt';

% laneId = [0; 1; 16; 17; 34];
% 
% for segId = 29:30
%     for fgId = 0:1284
%         for mgId = 0:94
%             for li = 1:5
%                 rot_str = sprintf([folder_str rot_format], ...
%                     fgId, segId, laneId(li), mgId);
%                 if exist(rot_str, 'file')
%                     fprintf('FG: %d, Seg: %d, Mg: %d, Lane: %d\n', ...
%                         fgId, segId, mgId, laneId(li));
%                     
%                     data = load(rot_str);
%                     num_of_all_pnts = size(data, 1);
%                     num_of_pnts = num_of_all_pnts / 2;
%                     
%                     left.x = data(1:num_of_pnts, 1);
%                     left.y = data(1:num_of_pnts, 2);
%                     left.p = data(1:num_of_pnts, 3);
%                     
%                     right.x = data(1+num_of_pnts:end, 1);
%                     right.y = data(1+num_of_pnts:end, 2);
%                     right.p = data(1+num_of_pnts:end, 3);
%                     
%                     figure(200)
%                     plot(left.x(left.p > 0), left.y(left.p > 0), 'r.', ...
%                         right.x(right.p > 0), right.y(right.p > 0), 'b.');
%                     axis equal;
%                     title(['FG: ' num2str(fgId) ' Seg: ' num2str(segId) ...
%                         ' Mg: ' num2str(mgId) ' Lane ' num2str(laneId(li))]);
%                     
%                     pause(0.0);
%                 end
%             end
%         end
%     end
% end
% 


% file_index = [6, 29, 0, 0;
% 7, 29, 1, 0;
% 8, 29, 2, 0;
% 9, 29, 3, 0;
% 10, 29, 4, 0;
% 11, 29, 5, 0;
% 12, 29, 6, 0;
% 57, 29, 7, 16;
% 58, 29, 8, 16;
% 59, 29, 9, 16;
% 60, 29, 10, 16;
% 61, 29, 11, 16;
% 62, 29, 12, 16;
% 63, 29, 13, 16;
% 137, 29, 14, 16;
% 138, 29, 15, 16;
% 139, 29, 16, 16;
% 140, 29, 17, 16;
% 141, 29, 18, 16;
% 142, 29, 19, 16;
% 143, 29, 20, 16;
% 209, 29, 21, 0;
% 210, 29, 22, 0;
% 211, 29, 23, 0;
% 212, 29, 24, 0;
% 213, 29, 25, 0;
% 214, 29, 26, 0;
% 215, 29, 27, 0;
% 284, 29, 28, 1;
% 284, 29, 28, 34;
% 285, 29, 29, 1;
% 285, 29, 29, 34;
% 286, 29, 30, 1;
% 286, 29, 30, 34;
% 287, 29, 31, 1;
% 287, 29, 31, 34;
% 288, 29, 32, 1;
% 288, 29, 32, 34;
% 289, 29, 33, 1;
% 289, 29, 33, 34;
% 290, 29, 34, 1;
% 328, 29, 35, 0;
% 337, 29, 36, 1;
% 379, 29, 37, 16;
% 380, 29, 38, 16;
% 407, 29, 39, 0;
% 407, 29, 40, 16;
% 408, 29, 41, 0;
% 408, 29, 42, 16;
% 887, 29, 43, 1;
% 941, 29, 44, 0;
% 942, 29, 45, 0;
% 993, 29, 46, 0;
% 1007, 29, 47, 0;
% 1016, 29, 48, 0;
% 1017, 29, 49, 0;
% 1026, 29, 50, 0;
% 1087, 29, 51, 34;
% 1088, 29, 51, 0;
% 1124, 29, 52, 0;
% 1125, 29, 53, 0;
% 1229, 29, 54, 0;
% 1230, 29, 55, 0;
% 1231, 29, 56, 0;
% 1232, 29, 57, 0;
% 1283, 29, 58, 34;
% 7, 30, 0, 0;
% 8, 30, 1, 0;
% 8, 30, 2, 1;
% 9, 30, 3, 0;
% 9, 30, 4, 1;
% 10, 30, 5, 0;
% 10, 30, 6, 1;
% 11, 30, 7, 0;
% 11, 30, 8, 1;
% 12, 30, 9, 0;
% 12, 30, 10, 1;
% 13, 30, 11, 0;
% 58, 30, 12, 16;
% 58, 30, 13, 16;
% 59, 30, 14, 16;
% 59, 30, 15, 16;
% 60, 30, 16, 16;
% 60, 30, 17, 16;
% 61, 30, 18, 16;
% 61, 30, 19, 16;
% 62, 30, 20, 16;
% 62, 30, 21, 16;
% 63, 30, 22, 16;
% 63, 30, 23, 16;
% 64, 30, 24, 16;
% 138, 30, 25, 16;
% 138, 30, 26, 16;
% 139, 30, 27, 16;
% 139, 30, 28, 16;
% 140, 30, 29, 16;
% 140, 30, 30, 16;
% 141, 30, 31, 16;
% 141, 30, 32, 16;
% 142, 30, 33, 16;
% 142, 30, 34, 16;
% 143, 30, 35, 16;
% 144, 30, 36, 16;
% 210, 30, 37, 0;
% 211, 30, 38, 0;
% 211, 30, 39, 0;
% 212, 30, 40, 0;
% 212, 30, 41, 0;
% 213, 30, 42, 0;
% 213, 30, 43, 0;
% 214, 30, 44, 0;
% 214, 30, 45, 0;
% 215, 30, 46, 0;
% 215, 30, 47, 0;
% 216, 30, 48, 0;
% 285, 30, 49, 1;
% 286, 30, 50, 1;
% 287, 30, 51, 1;
% 288, 30, 52, 1;
% 289, 30, 53, 1;
% 290, 30, 54, 1;
% 328, 30, 55, 0;
% 329, 30, 56, 0;
% 337, 30, 57, 1;
% 338, 30, 58, 1;
% 379, 30, 59, 16;
% 379, 30, 60, 16;
% 380, 30, 61, 16;
% 407, 30, 62, 16;
% 407, 30, 63, 16;
% 408, 30, 64, 16;
% 408, 30, 65, 16;
% 409, 30, 66, 16;
% 887, 30, 67, 1;
% 941, 30, 68, 0;
% 942, 30, 69, 0;
% 993, 30, 70, 0;
% 994, 30, 71, 0;
% 1007, 30, 72, 0;
% 1007, 30, 73, 0;
% 1016, 30, 74, 0;
% 1016, 30, 75, 0;
% 1017, 30, 76, 0;
% 1026, 30, 77, 0;
% 1027, 30, 78, 0;
% 1087, 30, 79, 0;
% 1088, 30, 80, 0;
% 1124, 30, 81, 0;
% 1125, 30, 82, 0;
% 1229, 30, 83, 0;
% 1229, 30, 84, 0;
% 1230, 30, 85, 0;
% 1230, 30, 86, 0;
% 1231, 30, 87, 0;
% 1231, 30, 88, 0;
% 1232, 30, 89, 0;
% 1232, 30, 90, 0;
% 1233, 30, 91, 0;
% 1283, 30, 92, 16;
% 1283, 30, 93, 16;
% 1284, 30, 94, 16;];

file_index = [6, 29, 0, 0;
7, 29, 1, 0;
7, 30, 0, 0;
8, 29, 2, 0;
8, 30, 1, 0;
8, 30, 2, 1;
9, 29, 3, 0;
9, 30, 3, 0;
9, 30, 4, 1;
10, 29, 4, 0;
10, 30, 5, 0;
10, 30, 6, 1;
11, 29, 5, 0;
11, 30, 7, 0;
11, 30, 8, 1;
12, 29, 6, 0;
12, 30, 9, 0;
12, 30, 10, 1;
13, 30, 11, 0;
57, 29, 7, 16;
58, 29, 8, 16;
58, 30, 12, 16;
58, 30, 13, 16;
59, 29, 9, 16;
59, 30, 14, 16;
59, 30, 15, 16;
60, 29, 10, 16;
60, 30, 16, 16;
60, 30, 17, 16;
61, 29, 11, 16;
61, 30, 18, 16;
61, 30, 19, 16;
62, 29, 12, 16;
62, 30, 20, 16;
62, 30, 21, 16;
63, 29, 13, 16;
63, 30, 22, 16;
63, 30, 23, 16;
64, 30, 24, 16;
137, 29, 14, 16;
138, 29, 15, 16;
138, 30, 25, 16;
138, 30, 26, 16;
139, 29, 16, 16;
139, 30, 27, 16;
139, 30, 28, 16;
140, 29, 17, 16;
140, 30, 29, 16;
140, 30, 30, 16;
141, 29, 18, 16;
141, 30, 31, 16;
141, 30, 32, 16;
142, 29, 19, 16;
142, 30, 33, 16;
142, 30, 34, 16;
143, 29, 20, 16;
143, 30, 35, 16;
144, 30, 36, 16;
209, 29, 21, 0;
210, 29, 22, 0;
210, 30, 37, 0;
211, 29, 23, 0;
211, 30, 38, 0;
211, 30, 39, 0;
212, 29, 24, 0;
212, 30, 40, 0;
212, 30, 41, 0;
213, 29, 25, 0;
213, 30, 42, 0;
213, 30, 43, 0;
214, 29, 26, 0;
214, 30, 44, 0;
214, 30, 45, 0;
215, 29, 27, 0;
215, 30, 46, 0;
215, 30, 47, 0;
216, 30, 48, 0;
284, 29, 28, 1;
284, 29, 28, 34;
285, 29, 29, 1;
285, 29, 29, 34;
285, 30, 49, 1;
286, 29, 30, 1;
286, 29, 30, 34;
286, 30, 50, 1;
287, 29, 31, 1;
287, 29, 31, 34;
287, 30, 51, 1;
288, 29, 32, 1;
288, 29, 32, 34;
288, 30, 52, 1;
289, 29, 33, 1;
289, 29, 33, 34;
289, 30, 53, 1;
290, 29, 34, 1;
290, 30, 54, 1;
328, 29, 35, 0;
328, 30, 55, 0;
329, 30, 56, 0;
337, 29, 36, 1;
337, 30, 57, 1;
338, 30, 58, 1;
379, 29, 37, 16;
379, 30, 59, 16;
379, 30, 60, 16;
380, 29, 38, 16;
380, 30, 61, 16;
407, 29, 39, 0;
407, 29, 40, 16;
407, 30, 62, 16;
407, 30, 63, 16;
408, 29, 41, 0;
408, 29, 42, 16;
408, 30, 64, 16;
408, 30, 65, 16;
409, 30, 66, 16;
887, 29, 43, 1;
887, 30, 67, 1;
941, 29, 44, 0;
941, 30, 68, 0;
942, 29, 45, 0;
942, 30, 69, 0;
993, 29, 46, 0;
993, 30, 70, 0;
994, 30, 71, 0;
1007, 29, 47, 0;
1007, 30, 72, 0;
1007, 30, 73, 0;
1016, 29, 48, 0;
1016, 30, 74, 0;
1016, 30, 75, 0;
1017, 29, 49, 0;
1017, 30, 76, 0;
1026, 29, 50, 0;
1026, 30, 77, 0;
1027, 30, 78, 0;
1087, 29, 51, 34;
1087, 30, 79, 0;
1088, 29, 51, 0;
1088, 30, 80, 0;
1124, 29, 52, 0;
1124, 30, 81, 0;
1125, 29, 53, 0;
1125, 30, 82, 0;
1229, 29, 54, 0;
1229, 30, 83, 0;
1229, 30, 84, 0;
1230, 29, 55, 0;
1230, 30, 85, 0;
1230, 30, 86, 0;
1231, 29, 56, 0;
1231, 30, 87, 0;
1231, 30, 88, 0;
1232, 29, 57, 0;
1232, 30, 89, 0;
1232, 30, 90, 0;
1233, 30, 91, 0;
1283, 29, 58, 34;
1283, 30, 92, 16;
1283, 30, 93, 16;
1284, 30, 94, 16;
];

num_of_items = size(file_index, 1);
for ii = 77 % 1:num_of_items
    fgId = file_index(ii, 1);
    segId = file_index(ii, 2);
    mgId = file_index(ii, 3);
    laneId = file_index(ii, 4);
    rot_str = sprintf([folder_str0 rot_format], ...
        fgId, segId, laneId, mgId);
    if exist(rot_str, 'file')
        fprintf('FG: %d, Seg: %d, Mg: %d, Lane: %d\n', ...
            fgId, segId, mgId, laneId);
        
        data = load(rot_str);
        num_of_all_pnts = size(data, 1);
        num_of_pnts = num_of_all_pnts / 2;
        
        left.x = data(1:num_of_pnts, 1);
        left.y = data(1:num_of_pnts, 2);
        left.p = data(1:num_of_pnts, 3);
        
        right.x = data(1+num_of_pnts:end, 1);
        right.y = data(1+num_of_pnts:end, 2);
        right.p = data(1+num_of_pnts:end, 3);
        
        figure(200); subplot(211);
        plot(left.x(left.p > 0), left.y(left.p > 0), 'r.', ...
            right.x(right.p > 0), right.y(right.p > 0), 'b.');
        axis equal;
        title(['FG: ' num2str(fgId) ' Seg: ' num2str(segId) ...
            ' Mg: ' num2str(mgId) ' Lane ' num2str(laneId)]);
        
        pause(0.0);
    end
    
    side_str = sprintf([folder_str1 'fg_%d_source.txt'], file_index(ii, 1));
    if exist(side_str, 'file')
        data = load(side_str);
        num_of_all_pnts = size(data, 1);
        num_of_pnts = num_of_all_pnts / 2;
        sleft.x = data(1:num_of_pnts, 1);
        sleft.y = data(1:num_of_pnts, 2);
        sleft.p = data(1:num_of_pnts, 3);
        
        sright.x = data(1+num_of_pnts:end, 1);
        sright.y = data(1+num_of_pnts:end, 2);
        sright.p = data(1+num_of_pnts:end, 3);
        
        
        figure(200); subplot(212);
        plot(sleft.x(sleft.p > 0), sleft.y(sleft.p > 0), 'r.', ...
            sright.x(sright.p > 0), sright.y(sright.p > 0), 'b.');
        axis equal;
        title(['Side lane data of FG: ' num2str(fgId) ...
            ' Seg: ' num2str(segId) ...
            ' Mg: ' num2str(mgId) ' Lane ' num2str(laneId)]);
        
        pause(0.0);
    end
end